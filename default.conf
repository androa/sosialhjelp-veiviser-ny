events {}
http {
  # Trenger ikke accesslogger p√• NAIS siden dette er innebygd i platformen
  access_log    off;
  include /etc/nginx/mime.types;
  sendfile on;

  server {
    listen       80;  

    # Health check for NAIS
    location = /sosialhjelp/internal/isAlive {
      return 200 "Application:UP";
      add_header Content-Type text/plain;
    }

    # Readiness check for NAIS
    location = /sosialhjelp/internal/isAlive {
      return 200 "Application:READY";
      add_header Content-Type text/plain;
    }

    # React app:
    location ^~ /sosialhjelp {
      index  index.html index.html;
      root /usr/share/nginx/html;
      try_files $uri $uri/ /sosialhjelp/index.html;
      add_header Cache-Control no-cache;

      # CORS allow all
      add_header Access-Control-Allow-Origin *;
      add_header Access-Control-Max-Age 3600;
      add_header Access-Control-Expose-Headers Content-Length;
      add_header Access-Control-Allow-Headers Range;
    }

    location / {
      # beholder default root slik at vi kan swappe ut med stock nginx
      root   /usr/share/nginx/html;
      index  index.html index.htm;
      try_files $uri $uri/ /index.html;

      # Hvis vi tillater browser-caching vil vi ikke ha nedetidsfri deploy (!)
      add_header Cache-Control no-cache;

       # CORS allow all
      add_header Access-Control-Allow-Origin *;
      add_header Access-Control-Max-Age 3600;
      add_header Access-Control-Expose-Headers Content-Length;
      add_header Access-Control-Allow-Headers Range;
    }
  }
}